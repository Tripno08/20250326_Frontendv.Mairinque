#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo 'ğŸ—ï¸ğŸ‘· Estilizando, testando e construindo seu projeto antes de commitar'

# Verificar Prettier
npm run check-format ||
(
    echo 'ğŸ¤¢ğŸ¤® FormataÃ§Ã£o com Prettier falhou ğŸ¤®ğŸ¤¢
            Rode npm run format, adicione as mudanÃ§as e tente commitar novamente.';
    false;
)

# Verificar ESLint
npm run check-lint ||
(
    echo 'ğŸ˜¤ğŸ€ ESLint falhou ğŸ˜¤ğŸ€
            FaÃ§a as correÃ§Ãµes necessÃ¡rias listadas acima e tente novamente.'
    false;
)

# Verificar tipos do TypeScript
npm run check-types ||
(
    echo 'ğŸ¤¡ğŸ˜‚ VerificaÃ§Ã£o de tipos falhou ğŸ˜‚ğŸ¤¡
            Corrija os erros de tipo listados acima e tente novamente.'
    false;
)

# Se tudo passar... tente construir o projeto
echo 'ğŸ¤”ğŸ¤” Tentando construir agora... ğŸ¤”ğŸ¤”'

npm run build ||
(
    echo 'âŒğŸ‘· ConstruÃ§Ã£o do Next.js falhou ğŸ‘·âŒ
            Veja os erros acima para ver o que deu errado.'
    false;
)

# Se tudo passar... finalmente, execute os testes
echo 'ğŸ¤”ğŸ¤” Executando testes... ğŸ¤”ğŸ¤”'

npm run test ||
(
    echo 'âŒğŸ§ª Testes falharam ğŸ§ªâŒ
            Veja os erros acima para ver o que deu errado.'
    false;
)

# Se chegarmos aqui, commit pode prosseguir
echo 'âœ…âœ… VocÃª ganhou dessa vez... Estou permitindo o commit âœ…âœ…'
